<style type="text/css">
    table{
        border-collapse:collapse;
        text-align:center;
        width:100%
    }
    tr:nth-child(even){
        background-color:#f2f2f2
    }
    tr:hover{
        background-color:#abf2af
    }
    .ok{
        color:#d0d0d0
    }
    input{
        width:100%
    }
</style>

<div class="table-container-submit">
	<input type="text" id="tableSearch" onkeyup="searchTable('tableSearch','tbl',0)" placeholder="Search for alias...">
	<h1>Submit An Answer:</h1>
	<table id="tbl">
		<tr>
			<th onclick="sortTable(0,'tbl');">Alias</th>
			<th onclick="sortTable(1,'tbl')">Part of Number</th>
			<th onclick="sortTable(2,'tbl')">Number Length</th>
			<th onclick="sortTable(3,'tbl')">Factorized Count</th>
			<th onclick="sortTable(4,'tbl')">First Factorized Time</th>
		</tr>
	</table>
</div>

<script>
$(document).ready(function(){
	var tbl  = document.getElementsByTagName('table');
	var dat  = JSON.parse('{{course.JSON}}')
	var show = -1

	function submit(e){
		if(!e)
			e=window.event
		if((e.keyCode||e.which)=='13'&&RegExp("^[0-9 ]*$").text(e.target.value)){
			somehowSubmitToServer()
		}
	}

    function expand(i){
        if(show>=0)
            tbl.deleteRow(show)
        var col       = tbl.insertRow(i).insertCell(0)
        col.colSpan   = 5
        col.innerHTML = "<input onkeypress='submit(this.id)' placeholder='"+(dat[i-2][0].factorized_by_me?"You have alraedy submitted. Submit again if you want":"Put factors spearated by space and hit enter to submit")+"'</input>"
        show          = i
    }

    function refresh(){
    	for(var i=1;i<tbl.rows.length;i++)
    		tbl.deleteRow(1)
		for(var i=0;i<dat.length;i++){
	        var row                     = tbl.insertRow(-1)
	        row.onclick                 = function(j){return function(){expand(j+2)}}(i)
	        row.insertCell(0).innerHTML = dat[i][0].alias
	        row.insertCell(1).innerHTML = dat[i][0].num_submit
	        row.insertCell(2).innerHTML = dat[i][0].num_length
	        row.insertCell(3).innerHTML = dat[i][0].factor_count
	        row.insertCell(4).innerHTML = dat[i][0].first_factor_time
	        row.className               = dat[i][0].factorized_by_me?"ok":null
	    }
	}
	refresh()
});
</script>
