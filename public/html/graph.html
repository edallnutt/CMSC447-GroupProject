<div class="sub-ans-table">
    <div id="btn-group">
        <button class="btn btn-primary" id="alias" onclick="sortChart(0)">Sort by Alias</button>
        <button class="btn btn-primary" id="factor_count" onclick="sortChart(1)">Sort by Factor Count</button>
        <button class="btn btn-primary" id="bit_length" onclick="sortChart(2)">Sort by Bit Length</button>
    </div>
    <div id="chart_div" style="width: 100%; height: 100%"></div>
    <br/><br/>
    <div id="btn-group">
        <button class="btn btn-primary" id="alias" onclick="sortChart(0)">Sort by Alias</button>
        <button class="btn btn-primary" id="factor_count" onclick="sortChart(1)">Sort by Factor Count</button>
        <button class="btn btn-primary" id="bit_length" onclick="sortChart(2)">Sort by Bit Length</button>
    </div>
    <script>
        google.charts.load('current', {'packages':['bar']});
        google.charts.setOnLoadCallback(drawChart);

        var email_num = '{{student_num}}';                              // Number associated with user
        var courseData = JSON.parse('{{course.JSON}}');                 // Project data
        var dataArray = [['Alias', 'Factor Count', 'Bit Length']];      // Array data for bar chart

        // Create array data for bar chart
        for(var i = 0; i < courseData.length; i++){
            if(courseData[i][0].type === "admin"){
                for(var sub in courseData[i][0].nums){
                    dataArray.push([courseData[i][0].nums[sub].alias, courseData[i][0].nums[sub].factor_count, courseData[i][0].nums[sub].num_length])
                }
            }
            else{
                dataArray.push([courseData[i][0].alias, courseData[i][0].factor_count, courseData[i][0].num_length])
            }
        }

        // Draw Initial Graph
        function drawChart() {

            /* Display bar chart */

            var data = google.visualization.arrayToDataTable(dataArray);

            var view = new google.visualization.DataView(data);
            view.setColumns([{ type: "string" }, { type: "string" }, { type: "string" }]);
            var numRows = data.getNumberOfRows();
            var heightMult = 60;
            if(numRows > 15){
                heightMult = 40;
            }

            var options = {
                chart: {
                    title: 'Number Results',
                    subtitle: 'RSA Factoring Challenge',
                },
                series: {
                    0: { axis: 'count' },
                    1: { axis: 'bits' }
                },
                axes: {
                    x: {
                        count: { label: 'Factor Count' },
                        bits: { side: 'top', label: 'Bit Length' }
                    }
                },
                bars: 'horizontal',             // Required for Material Bar Charts.
                hAxis: {format: 'decimal'},
                width: 1200,
                height: numRows * heightMult,
                colors: ['#1b9e77', '#fe9834']
            };

            var chart = new google.charts.Bar(document.getElementById('chart_div'));

            chart.draw(data, google.charts.Bar.convertOptions(options));

        }

        // Sort and redraw graph
        function sortChart(type) {

            dataArray = insertionSort(dataArray, type);

            /* Display bar chart */

            var data = google.visualization.arrayToDataTable(dataArray);

            var newView = new google.visualization.DataView(data);
            newView.setColumns([{ type: "string" }, { type: "string" }, { type: "string" }]);
            var numRows = data.getNumberOfRows();
            var heightMult = 60;
            if(numRows > 15){
                heightMult = 40;
            }

            var options = {
                chart: {
                    title: 'Number Results',
                    subtitle: 'RSA Factoring Challenge',
                },
                series: {
                    0: { axis: 'count' },
                    1: { axis: 'bits' }
                },
                axes: {
                    x: {
                        count: { label: 'Factor Count' },
                        bits: { side: 'top', label: 'Bit Length' }
                    }
                },
                bars: 'horizontal', // Required for Material Bar Charts.
                hAxis: {format: 'decimal'},
                width: 1200,
                height: numRows * heightMult,
                colors: ['#1b9e77', '#fe9834']
            };

            var chart = new google.charts.Bar(document.getElementById('chart_div'));

            chart.draw(data, google.charts.Bar.convertOptions(options));
        }
    </script>
</div>
